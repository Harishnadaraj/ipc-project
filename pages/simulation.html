<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>IPC Framework â€” Simulation</title>

<style>
/* GLOBAL PAGE STYLE */
body {
    margin: 0;
    background: #f5f7fa;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", Inter, Arial;
}

/* NAVBAR */
.navbar {
    width: 100%;
    background: #ffffffcc;
    backdrop-filter: blur(10px);
    padding: 14px 26px;
    display: flex;
    justify-content: space-between;
    position: sticky;
    top: 0;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    z-index: 1000;
}

.brand {
    font-size: 20px;
    font-weight: 700;
    color: #0071e3;
}

.nav-links a {
    margin-left: 18px;
    text-decoration: none;
    font-weight: 600;
    color: #1d1d1f;
}

.nav-links a:hover {
    color: #0071e3;
}

/* PAGE CONTAINER */
.container {
    max-width: 1150px;
    margin: 30px auto;
    padding: 20px;
}

/* CARD */
.card {
    background: #fff;
    padding: 22px;
    border-radius: 14px;
    margin-bottom: 22px;
    box-shadow: 0 14px 40px rgba(0,0,0,0.06);
}

/* SIMULATION AREA */
.sim-box {
    background: #eef2f8;
    border-radius: 12px;
    padding: 20px;
    height: 440px;
    position: relative;
    overflow: hidden;
}

.entity {
    width: 160px;
    height: 80px;
    background: #ffffff;
    position: absolute;
    border-radius: 12px;
    box-shadow: 0 10px 20px rgba(0,0,0,0.08);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
}

/* Entities */
#producer { top: 40%; left: 30px; }
#consumer { top: 40%; right: 30px; }

/* Moving Data Packet */
.packet {
    width: 70px;
    height: 30px;
    background: #0071e3;
    color: white;
    font-size: 14px;
    border-radius: 999px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    opacity: 0;
}

/* Controls */
.controls {
    margin-top: 16px;
}
button {
    padding: 12px 18px;
    margin-right: 10px;
    border-radius: 8px;
    border: none;
    font-weight: 600;
    cursor: pointer;
}
.play { background: #0071e3; color: white; }
.reset { background: #d8d8d8; }

/* Narration Box */
.narration {
    margin-top: 18px;
    background: #eef6ff;
    padding: 14px;
    border-left: 4px solid #0071e3;
    border-radius: 6px;
    font-size: 15px;
    color: #334155;
}

/* Mode Selector */
.mode-box {
    margin: 10px 0;
    padding: 14px;
    background: #ffffff;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.04);
}

.mode-box select {
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #cfcfcf;
}
</style>

</head>
<body>

<!-- NAVBAR -->
<div class="navbar">
    <div class="brand">IPC Framework</div>
    <div class="nav-links">
        <a href="../index.html">Home</a>
        <a href="overview.html">Overview</a>
        <a href="modules.html">Modules</a>
        <a href="functionalities.html">Functionalities</a>
        <a href="technology.html">Technology</a>
        <a href="execution.html">Execution Plan</a>
        <a href="examples.html">Examples</a>
        <a href="simulation.html">Simulation</a>
        <a href="risks.html">Risks</a>
        <a href="future.html">Future Enhancements</a>
    </div>
</div>


<!-- PAGE CONTENT -->
<div class="container">

    <div class="card">
        <h1>IPC Simulation</h1>
        <p>
            This real-time animated simulation demonstrates how data travels between processes using:
            <b>FIFO</b>, <b>Message Queues</b>, and <b>Shared Memory</b>.  
            Watch the packet move, step-by-step, as IPC mechanisms operate behind the scenes.
        </p>
    </div>

    <!-- MODE SELECTION -->
    <div class="mode-box">
        <h3>Select IPC Mechanism</h3>
        <select id="modeSelector">
            <option value="fifo">FIFO (Named Pipe)</option>
            <option value="mq">Message Queue</option>
            <option value="shm">Shared Memory</option>
        </select>
    </div>

    <!-- SIMULATION BOX -->
    <div class="card">
        <h2>Simulation Area</h2>
        <div class="sim-box">

            <!-- Producer -->
            <div id="producer" class="entity">Producer</div>

            <!-- Data Packet -->
            <div id="packet" class="packet">DATA</div>

            <!-- Consumer -->
            <div id="consumer" class="entity">Consumer</div>
        </div>

        <!-- Controls -->
        <div class="controls">
            <button class="play" onclick="playSimulation()">Play Simulation</button>
            <button class="reset" onclick="resetSimulation()">Reset</button>
        </div>

        <!-- Narration -->
        <div id="narration" class="narration">
            Select a mode and press <b>Play</b> to begin the IPC simulation.
        </div>
    </div>

</div>


<script>
/* SCRIPT CONTROLS */
let packet = document.getElementById("packet");
let narration = document.getElementById("narration");
let modeSelector = document.getElementById("modeSelector");

function resetSimulation() {
    packet.style.left = "120px";
    packet.style.opacity = "0";
    narration.innerHTML = "Simulation reset. Choose a mode and press Play.";
}

function playSimulation() {
    let mode = modeSelector.value;

    resetSimulation();

    setTimeout(() => {
        packet.style.opacity = "1";
        if (mode === "fifo") runFIFO();
        if (mode === "mq") runMQ();
        if (mode === "shm") runSHM();
    }, 400);
}

/* FIFO ANIMATION */
function runFIFO() {
    narration.innerHTML = "<b>FIFO Mode:</b> Producer writes bytes sequentially through a pipe.";

    packet.animate([
        { left: "120px" },
        { left: "50%" },
        { left: "82%" }
    ], {
        duration: 3000,
        easing: "ease-in-out",
        fill: "forwards"
    });

    setTimeout(() => {
        narration.innerHTML += "<br>Consumer reads bytes in the same order they were written.";
    }, 3000);
}

/* MESSAGE QUEUE ANIMATION */
function runMQ() {
    narration.innerHTML = "<b>Message Queue Mode:</b> Producer sends a structured message with priority.";

    packet.style.background = "#7c3aed";

    packet.animate([
        { left: "120px" },
        { transform: "translateY(-40px)", offset: 0.4 },
        { left: "82%" }
    ], {
        duration: 2800,
        easing: "ease-in-out",
        fill: "forwards"
    });

    setTimeout(() => {
        narration.innerHTML += "<br>Consumer receives the highest priority message first.";
    }, 2800);
}

/* SHARED MEMORY ANIMATION */
function runSHM() {
    narration.innerHTML = "<b>Shared Memory Mode:</b> Producer writes directly into a common memory block.";

    packet.style.background = "#16a34a"; // green

    packet.animate([
        { left: "120px" },
        { left: "50%", offset: 0.5 },
        { left: "82%" }
    ], {
        duration: 3200,
        easing: "ease-in-out",
        fill: "forwards"
    });

    setTimeout(() => {
        narration.innerHTML += "<br>Consumer reads instantly from shared memory using semaphores.";
    }, 3200);
}
</script>

</body>
</html>
